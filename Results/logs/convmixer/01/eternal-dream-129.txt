PS C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN> C:/ProgramData/Anaconda3/envs/tf/python.exe c:/Users/Tuna/Desktop/2022-spring/CS402/SPDPvCNN/training.py
wandb: Currently logged in as: kuantuna (spdpvcnn). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.12.16
wandb: Run data is saved locally in C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220526_101745-1yqypmso
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run eternal-dream-129
wandb:  View project at https://wandb.ai/spdpvcnn/convmixer
wandb:  View run at https://wandb.ai/spdpvcnn/convmixer/runs/1yqypmso
Training data samples: 32465
Validation data samples: 3607
Test data samples: 9018
2022-05-26 10:17:51.684925: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-05-26 10:17:52.079151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3495 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 3060 Laptop GPU, pci bus id: 0000:01:00.0, compute capability: 8.6
2022-05-26 10:17:52.080821: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 1165883080 exceeds 10% of free system memory.
2022-05-26 10:19:37.879384: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 1165883080 exceeds 10% of free system memory.
Getting the ConvMixer model...
wandb: WARNING The save_model argument by default saves the model in the HDF5 format that cannot save custom objects like subclassed models and custom layers. This behavior will be deprecated in a future release in favor of the SavedModel format. Meanwhile, the HDF5 model is saved as W&B files and the SavedModel as W&B Artifacts.
2022-05-26 10:20:20.116960: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 1165883080 exceeds 10% of free system memory.
2022-05-26 10:20:20.377837: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 1165883080 exceeds 10% of free system memory.
Epoch 1/500
2022-05-26 10:20:22.456337: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2022-05-26 10:20:23.805862: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
2022-05-26 10:20:26.534762: I tensorflow/stream_executor/cuda/cuda_blas.cc:1760] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
2022-05-26 10:20:27.520108: W tensorflow/core/common_runtime/bfc_allocator.cc:272] Allocator (GPU_0_bfc) ran out of memory trying to allocate 561.02MiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2022-05-26 10:20:27.602137: W tensorflow/core/common_runtime/bfc_allocator.cc:272] Allocator (GPU_0_bfc) ran out of memory trying to allocate 676.06MiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
   6/1015 [..............................] - ETA: 3:02 - loss: 1.1338 - accuracy: 0.2917WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0450s vs `on_train_batch_end` time: 0.1132s). Check your callbacks.
1015/1015 [==============================] - 195s 185ms/step - loss: 1.0930 - accuracy: 0.4282 - val_loss: 1.0702 - val_accuracy: 0.4719
[[ 575  733  489]
 [1194 2732 1699]
 [ 470  677  449]]
f1 score: 0.443272332575852
282/282 [==============================] - 11s 37ms/step - loss: 1.5095 - accuracy: 0.4165
buy&sell test accuracy_t: 1024 / 3393 = 0.3018
buy&sell test accuracy_o: 1024 / 4876 = 0.21



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
2022-05-26 10:23:56.764722: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 1165883080 exceeds 10% of free system memory.
Epoch 2/500
1015/1015 [==============================] - 190s 187ms/step - loss: 1.0682 - accuracy: 0.5083 - val_loss: 1.0721 - val_accuracy: 0.4965
[[ 436  730  631]
 [ 577 2837 2211]
 [ 351  697  548]]
f1 score: 0.4517630673031208
282/282 [==============================] - 11s 37ms/step - loss: 1.5893 - accuracy: 0.4237
buy&sell test accuracy_t: 984 / 3393 = 0.29
buy&sell test accuracy_o: 984 / 4754 = 0.207



Epoch 3/500
1015/1015 [==============================] - 188s 185ms/step - loss: 1.0556 - accuracy: 0.5314 - val_loss: 1.0603 - val_accuracy: 0.5065
[[ 362  768  667]
 [ 537 2960 2128]
 [ 312  734  550]]
f1 score: 0.4534391405987864
282/282 [==============================] - 11s 37ms/step - loss: 1.5979 - accuracy: 0.4294
buy&sell test accuracy_t: 912 / 3393 = 0.2688
buy&sell test accuracy_o: 912 / 4556 = 0.2002



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 4/500
1015/1015 [==============================] - 188s 185ms/step - loss: 1.0441 - accuracy: 0.5482 - val_loss: 1.0511 - val_accuracy: 0.5276
[[ 267  786  744]
 [ 353 2999 2273]
 [ 246  746  604]]
f1 score: 0.4493181021231598
282/282 [==============================] - 10s 37ms/step - loss: 1.6151 - accuracy: 0.4291
buy&sell test accuracy_t: 871 / 3393 = 0.2567
buy&sell test accuracy_o: 871 / 4487 = 0.1941



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 5/500
1015/1015 [==============================] - 188s 185ms/step - loss: 1.0330 - accuracy: 0.5622 - val_loss: 1.0388 - val_accuracy: 0.5523
[[ 231  824  742]
 [ 309 3150 2166]
 [ 211  786  599]]
f1 score: 0.4560752288416163
282/282 [==============================] - 11s 37ms/step - loss: 1.5267 - accuracy: 0.4413
buy&sell test accuracy_t: 830 / 3393 = 0.2446
buy&sell test accuracy_o: 830 / 4258 = 0.1949



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 6/500
1015/1015 [==============================] - 188s 185ms/step - loss: 1.0216 - accuracy: 0.5756 - val_loss: 1.0269 - val_accuracy: 0.5567
[[ 230  832  735]
 [ 317 3158 2150]
 [ 215  788  593]]
f1 score: 0.45588770419096974
282/282 [==============================] - 11s 37ms/step - loss: 1.5281 - accuracy: 0.4415
buy&sell test accuracy_t: 823 / 3393 = 0.2426
buy&sell test accuracy_o: 823 / 4240 = 0.1941



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 7/500
1015/1015 [==============================] - 189s 186ms/step - loss: 1.0109 - accuracy: 0.5890 - val_loss: 1.0160 - val_accuracy: 0.5672
[[ 210  863  724]
 [ 304 3286 2035]
 [ 197  828  571]]
f1 score: 0.46105317760820785
282/282 [==============================] - 11s 37ms/step - loss: 1.4504 - accuracy: 0.4510
buy&sell test accuracy_t: 781 / 3393 = 0.2302
buy&sell test accuracy_o: 781 / 4041 = 0.1933



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 8/500
1015/1015 [==============================] - 186s 183ms/step - loss: 1.0012 - accuracy: 0.5942 - val_loss: 1.0056 - val_accuracy: 0.5764
[[ 213  874  710]
 [ 297 3323 2005]
 [ 200  837  559]]
f1 score: 0.4634057432188719
282/282 [==============================] - 10s 37ms/step - loss: 1.4157 - accuracy: 0.4541
buy&sell test accuracy_t: 772 / 3393 = 0.2275
buy&sell test accuracy_o: 772 / 3984 = 0.1938



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 9/500
1015/1015 [==============================] - 186s 183ms/step - loss: 0.9922 - accuracy: 0.6046 - val_loss: 0.9936 - val_accuracy: 0.5925
[[ 222  909  666]
 [ 312 3472 1841]
 [ 202  867  527]]
f1 score: 0.4735747200365542
282/282 [==============================] - 10s 36ms/step - loss: 1.3394 - accuracy: 0.4681
buy&sell test accuracy_t: 749 / 3393 = 0.2207
buy&sell test accuracy_o: 749 / 3770 = 0.1987



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 10/500
1015/1015 [==============================] - 185s 183ms/step - loss: 0.9832 - accuracy: 0.6127 - val_loss: 0.9827 - val_accuracy: 0.5963
[[ 263  905  629]
 [ 395 3514 1716]
 [ 246  872  478]]
f1 score: 0.4786812805924377
282/282 [==============================] - 10s 36ms/step - loss: 1.3017 - accuracy: 0.4718
buy&sell test accuracy_t: 741 / 3393 = 0.2184
buy&sell test accuracy_o: 741 / 3727 = 0.1988



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 11/500
1015/1015 [==============================] - 185s 183ms/step - loss: 0.9740 - accuracy: 0.6200 - val_loss: 0.9728 - val_accuracy: 0.6085
[[ 226  907  664]
 [ 328 3469 1828]
 [ 205  877  514]]
f1 score: 0.4726021998592092
282/282 [==============================] - 10s 36ms/step - loss: 1.3128 - accuracy: 0.4667
buy&sell test accuracy_t: 740 / 3393 = 0.2181
buy&sell test accuracy_o: 740 / 3765 = 0.1965



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 12/500
1015/1015 [==============================] - 186s 183ms/step - loss: 0.9657 - accuracy: 0.6262 - val_loss: 0.9701 - val_accuracy: 0.6005
[[ 214  945  638]
 [ 299 3654 1672]
 [ 197  905  494]]
f1 score: 0.48335440657688256
282/282 [==============================] - 10s 37ms/step - loss: 1.2609 - accuracy: 0.4837
buy&sell test accuracy_t: 708 / 3393 = 0.2087
buy&sell test accuracy_o: 708 / 3514 = 0.2015



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 13/500
1015/1015 [==============================] - 186s 184ms/step - loss: 0.9588 - accuracy: 0.6278 - val_loss: 0.9563 - val_accuracy: 0.6182
[[ 204  939  654]
 [ 269 3639 1717]
 [ 180  910  506]]
f1 score: 0.48172609843320086
282/282 [==============================] - 11s 37ms/step - loss: 1.2424 - accuracy: 0.4823
buy&sell test accuracy_t: 710 / 3393 = 0.2093
buy&sell test accuracy_o: 710 / 3530 = 0.2011



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 14/500
1015/1015 [==============================] - 186s 183ms/step - loss: 0.9502 - accuracy: 0.6350 - val_loss: 0.9483 - val_accuracy: 0.6210
[[ 190 1015  592]
 [ 260 3929 1436]
 [ 183  958  455]]
f1 score: 0.4958587517324953
282/282 [==============================] - 11s 37ms/step - loss: 1.1526 - accuracy: 0.5072
buy&sell test accuracy_t: 645 / 3393 = 0.1901
buy&sell test accuracy_o: 645 / 3116 = 0.207



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 15/500
1015/1015 [==============================] - 186s 183ms/step - loss: 0.9436 - accuracy: 0.6387 - val_loss: 0.9401 - val_accuracy: 0.6285
[[ 225 1038  534]
 [ 293 4042 1290]
 [ 197  984  415]]
f1 score: 0.5053813742838941
282/282 [==============================] - 11s 37ms/step - loss: 1.1035 - accuracy: 0.5192
buy&sell test accuracy_t: 640 / 3393 = 0.1886
buy&sell test accuracy_o: 640 / 2954 = 0.2167



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 16/500
1015/1015 [==============================] - 186s 183ms/step - loss: 0.9366 - accuracy: 0.6387 - val_loss: 0.9368 - val_accuracy: 0.6271
[[ 195 1120  482]
 [ 248 4336 1041]
 [ 180 1036  380]]
f1 score: 0.5169668625809071
282/282 [==============================] - 11s 37ms/step - loss: 1.0529 - accuracy: 0.5446
buy&sell test accuracy_t: 575 / 3393 = 0.1695
buy&sell test accuracy_o: 575 / 2526 = 0.2276



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 17/500
1015/1015 [==============================] - 187s 184ms/step - loss: 0.9294 - accuracy: 0.6424 - val_loss: 0.9288 - val_accuracy: 0.6291
[[ 253 1164  380]
 [ 292 4511  822]
 [ 220 1073  303]]
f1 score: 0.5287618791427107
282/282 [==============================] - 11s 37ms/step - loss: 1.0195 - accuracy: 0.5619
buy&sell test accuracy_t: 556 / 3393 = 0.1639
buy&sell test accuracy_o: 556 / 2270 = 0.2449



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 18/500
1015/1015 [==============================] - 187s 184ms/step - loss: 0.9229 - accuracy: 0.6450 - val_loss: 0.9225 - val_accuracy: 0.6310
[[ 217 1228  352]
 [ 250 4679  696]
 [ 202 1138  256]]
f1 score: 0.5270164522849409
282/282 [==============================] - 11s 37ms/step - loss: 0.9969 - accuracy: 0.5713
buy&sell test accuracy_t: 473 / 3393 = 0.1394
buy&sell test accuracy_o: 473 / 1973 = 0.2397



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 19/500
1015/1015 [==============================] - 188s 185ms/step - loss: 0.9176 - accuracy: 0.6451 - val_loss: 0.9125 - val_accuracy: 0.6379
[[ 232 1258  307]
 [ 258 4683  684]
 [ 197 1167  232]]
f1 score: 0.5251657239962109
282/282 [==============================] - 11s 37ms/step - loss: 1.0009 - accuracy: 0.5707
buy&sell test accuracy_t: 464 / 3393 = 0.1368
buy&sell test accuracy_o: 464 / 1910 = 0.2429



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 20/500
1015/1015 [==============================] - 207s 204ms/step - loss: 0.9121 - accuracy: 0.6469 - val_loss: 0.9105 - val_accuracy: 0.6379
[[ 181 1428  188]
 [ 190 5080  355]
 [ 171 1304  121]]
f1 score: 0.5214234772441106
282/282 [==============================] - 16s 54ms/step - loss: 0.9849 - accuracy: 0.5968
buy&sell test accuracy_t: 302 / 3393 = 0.089
buy&sell test accuracy_o: 302 / 1206 = 0.2504



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 21/500
1015/1015 [==============================] - 295s 291ms/step - loss: 0.9062 - accuracy: 0.6503 - val_loss: 0.9046 - val_accuracy: 0.6396
[[ 227 1447  123]
 [ 233 5167  225]
 [ 195 1312   89]]
f1 score: 0.5280649678990647
282/282 [==============================] - 16s 55ms/step - loss: 0.9716 - accuracy: 0.6080
buy&sell test accuracy_t: 316 / 3393 = 0.0931
buy&sell test accuracy_o: 316 / 1092 = 0.2894



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 22/500
1015/1015 [==============================] - 294s 290ms/step - loss: 0.9005 - accuracy: 0.6509 - val_loss: 0.9005 - val_accuracy: 0.6446
[[ 181 1471  145]
 [ 171 5197  257]
 [ 165 1331  100]]
f1 score: 0.5239168092960934
282/282 [==============================] - 16s 54ms/step - loss: 0.9799 - accuracy: 0.6075
buy&sell test accuracy_t: 281 / 3393 = 0.0828
buy&sell test accuracy_o: 281 / 1019 = 0.2758



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 23/500
1015/1015 [==============================] - 294s 289ms/step - loss: 0.8975 - accuracy: 0.6516 - val_loss: 0.8967 - val_accuracy: 0.6451
[[ 196 1510   91]
 [ 186 5299  140]
 [ 176 1365   55]]
f1 score: 0.5225717701163576
282/282 [==============================] - 15s 54ms/step - loss: 0.9834 - accuracy: 0.6154
buy&sell test accuracy_t: 251 / 3393 = 0.074
buy&sell test accuracy_o: 251 / 844 = 0.2974



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 24/500
1015/1015 [==============================] - 294s 289ms/step - loss: 0.8930 - accuracy: 0.6547 - val_loss: 0.8942 - val_accuracy: 0.6437
[[ 182 1546   69]
 [ 161 5361  103]
 [ 153 1406   37]]
f1 score: 0.5187185511849417
282/282 [==============================] - 15s 54ms/step - loss: 1.0187 - accuracy: 0.6188
buy&sell test accuracy_t: 219 / 3393 = 0.0645
buy&sell test accuracy_o: 219 / 705 = 0.3106



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 25/500
1015/1015 [==============================] - 294s 289ms/step - loss: 0.8874 - accuracy: 0.6549 - val_loss: 0.8867 - val_accuracy: 0.6496
[[ 197 1534   66]
 [ 168 5358   99]
 [ 173 1392   31]]
f1 score: 0.5203086322544148
282/282 [==============================] - 15s 54ms/step - loss: 1.0062 - accuracy: 0.6194
buy&sell test accuracy_t: 228 / 3393 = 0.0672
buy&sell test accuracy_o: 228 / 734 = 0.3106



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 26/500
1015/1015 [==============================] - 294s 289ms/step - loss: 0.8848 - accuracy: 0.6535 - val_loss: 0.8860 - val_accuracy: 0.6504
[[ 160 1584   53]
 [ 137 5418   70]
 [ 134 1434   28]]
f1 score: 0.5149832596588323
282/282 [==============================] - 15s 54ms/step - loss: 1.0473 - accuracy: 0.6216
buy&sell test accuracy_t: 188 / 3393 = 0.0554
buy&sell test accuracy_o: 188 / 582 = 0.323



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 27/500
1015/1015 [==============================] - 294s 289ms/step - loss: 0.8807 - accuracy: 0.6535 - val_loss: 0.8820 - val_accuracy: 0.6479
[[ 171 1569   57]
 [ 129 5400   96]
 [ 145 1418   33]]
f1 score: 0.5177200340458967
282/282 [==============================] - 15s 54ms/step - loss: 1.0503 - accuracy: 0.6214
buy&sell test accuracy_t: 204 / 3393 = 0.0601
buy&sell test accuracy_o: 204 / 631 = 0.3233



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 28/500
1015/1015 [==============================] - 294s 289ms/step - loss: 0.8779 - accuracy: 0.6558 - val_loss: 0.8792 - val_accuracy: 0.6515
[[ 165 1579   53]
 [ 128 5413   84]
 [ 144 1422   30]]
f1 score: 0.5164573992522136
282/282 [==============================] - 16s 55ms/step - loss: 1.0443 - accuracy: 0.6219
buy&sell test accuracy_t: 195 / 3393 = 0.0575
buy&sell test accuracy_o: 195 / 604 = 0.3228



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 29/500
1015/1015 [==============================] - 294s 289ms/step - loss: 0.8740 - accuracy: 0.6576 - val_loss: 0.8821 - val_accuracy: 0.6474
[[ 161 1598   38]
 [ 120 5451   54]
 [ 132 1445   19]]
f1 score: 0.5146045381414311
282/282 [==============================] - 15s 54ms/step - loss: 1.0626 - accuracy: 0.6244
buy&sell test accuracy_t: 180 / 3393 = 0.0531
buy&sell test accuracy_o: 180 / 524 = 0.3435



Epoch 30/500
1015/1015 [==============================] - 294s 289ms/step - loss: 0.8708 - accuracy: 0.6574 - val_loss: 0.8730 - val_accuracy: 0.6507
[[ 181 1552   64]
 [ 146 5387   92]
 [ 162 1396   38]]
f1 score: 0.520466873988665
282/282 [==============================] - 15s 54ms/step - loss: 1.0124 - accuracy: 0.6216
buy&sell test accuracy_t: 219 / 3393 = 0.0645
buy&sell test accuracy_o: 219 / 683 = 0.3206



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 31/500
1015/1015 [==============================] - 294s 289ms/step - loss: 0.8671 - accuracy: 0.6562 - val_loss: 0.8739 - val_accuracy: 0.6501
[[ 154 1599   44]
 [ 118 5434   73]
 [ 136 1436   24]]
f1 score: 0.5137056095045938
282/282 [==============================] - 15s 54ms/step - loss: 1.0502 - accuracy: 0.6223
buy&sell test accuracy_t: 178 / 3393 = 0.0525
buy&sell test accuracy_o: 178 / 549 = 0.3242



Epoch 32/500
1015/1015 [==============================] - 294s 289ms/step - loss: 0.8653 - accuracy: 0.6586 - val_loss: 0.8719 - val_accuracy: 0.6490
[[ 171 1597   29]
 [ 130 5446   49]
 [ 155 1428   13]]
f1 score: 0.5149504993948993
282/282 [==============================] - 15s 54ms/step - loss: 1.0516 - accuracy: 0.6243
buy&sell test accuracy_t: 184 / 3393 = 0.0542
buy&sell test accuracy_o: 184 / 547 = 0.3364



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 33/500
1015/1015 [==============================] - 294s 289ms/step - loss: 0.8627 - accuracy: 0.6579 - val_loss: 0.8647 - val_accuracy: 0.6510
[[ 159 1584   54]
 [ 113 5421   91]
 [ 134 1426   36]]
f1 score: 0.5170621252956445
282/282 [==============================] - 15s 54ms/step - loss: 1.0832 - accuracy: 0.6228
buy&sell test accuracy_t: 195 / 3393 = 0.0575
buy&sell test accuracy_o: 195 / 587 = 0.3322



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 34/500
1015/1015 [==============================] - 294s 289ms/step - loss: 0.8588 - accuracy: 0.6586 - val_loss: 0.8676 - val_accuracy: 0.6504
[[ 154 1605   38]
 [ 111 5453   61]
 [ 138 1436   22]]
f1 score: 0.5142406550782992
282/282 [==============================] - 15s 54ms/step - loss: 1.0738 - accuracy: 0.6242
buy&sell test accuracy_t: 176 / 3393 = 0.0519
buy&sell test accuracy_o: 176 / 524 = 0.3359



Epoch 35/500
1015/1015 [==============================] - 294s 289ms/step - loss: 0.8573 - accuracy: 0.6582 - val_loss: 0.8641 - val_accuracy: 0.6507
[[ 141 1619   37]
 [  89 5476   60]
 [ 121 1454   21]]
f1 score: 0.512460177259043
282/282 [==============================] - 15s 54ms/step - loss: 1.0911 - accuracy: 0.6252
buy&sell test accuracy_t: 162 / 3393 = 0.0477
buy&sell test accuracy_o: 162 / 469 = 0.3454



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 36/500
1015/1015 [==============================] - 293s 289ms/step - loss: 0.8550 - accuracy: 0.6585 - val_loss: 0.8651 - val_accuracy: 0.6504
[[ 130 1626   41]
 [  77 5487   61]
 [ 110 1460   26]]
f1 score: 0.5119604051538031
282/282 [==============================] - 15s 54ms/step - loss: 1.0859 - accuracy: 0.6257
buy&sell test accuracy_t: 156 / 3393 = 0.046
buy&sell test accuracy_o: 156 / 445 = 0.3506



Epoch 37/500
1015/1015 [==============================] - 294s 289ms/step - loss: 0.8534 - accuracy: 0.6585 - val_loss: 0.8656 - val_accuracy: 0.6460
[[ 122 1654   21]
 [  81 5515   29]
 [ 113 1477    6]]
f1 score: 0.50639203691122
282/282 [==============================] - 15s 54ms/step - loss: 1.1082 - accuracy: 0.6257
buy&sell test accuracy_t: 128 / 3393 = 0.0377
buy&sell test accuracy_o: 128 / 372 = 0.3441



Epoch 38/500
1015/1015 [==============================] - 294s 289ms/step - loss: 0.8521 - accuracy: 0.6596 - val_loss: 0.8625 - val_accuracy: 0.6457
[[ 140 1631   26]
 [  86 5501   38]
 [ 121 1463   12]]
f1 score: 0.5111608880855293
282/282 [==============================] - 15s 54ms/step - loss: 1.1076 - accuracy: 0.6269
buy&sell test accuracy_t: 152 / 3393 = 0.0448
buy&sell test accuracy_o: 152 / 423 = 0.3593



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 39/500
1015/1015 [==============================] - 293s 289ms/step - loss: 0.8500 - accuracy: 0.6585 - val_loss: 0.8594 - val_accuracy: 0.6465
[[ 148 1632   17]
 [ 100 5496   29]
 [ 128 1464    4]]
f1 score: 0.5102637054275527
282/282 [==============================] - 15s 54ms/step - loss: 1.0832 - accuracy: 0.6263
buy&sell test accuracy_t: 152 / 3393 = 0.0448
buy&sell test accuracy_o: 152 / 426 = 0.3568



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 40/500
1015/1015 [==============================] - 294s 289ms/step - loss: 0.8485 - accuracy: 0.6598 - val_loss: 0.8586 - val_accuracy: 0.6468
[[ 141 1630   26]
 [  86 5504   35]
 [ 119 1466   11]]
f1 score: 0.5112463538851498
282/282 [==============================] - 15s 54ms/step - loss: 1.1001 - accuracy: 0.6272
buy&sell test accuracy_t: 152 / 3393 = 0.0448
buy&sell test accuracy_o: 152 / 418 = 0.3636



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 41/500
1015/1015 [==============================] - 294s 289ms/step - loss: 0.8466 - accuracy: 0.6593 - val_loss: 0.8587 - val_accuracy: 0.6462
[[ 140 1635   22]
 [  86 5508   31]
 [ 119 1468    9]]
f1 score: 0.5106371975571214
282/282 [==============================] - 15s 54ms/step - loss: 1.0911 - accuracy: 0.6273
buy&sell test accuracy_t: 149 / 3393 = 0.0439
buy&sell test accuracy_o: 149 / 407 = 0.3661



Epoch 42/500
1015/1015 [==============================] - 294s 289ms/step - loss: 0.8455 - accuracy: 0.6587 - val_loss: 0.8579 - val_accuracy: 0.6474
[[ 130 1649   18]
 [  71 5529   25]
 [ 113 1474    9]]
f1 score: 0.5095923196888501
282/282 [==============================] - 15s 54ms/step - loss: 1.1290 - accuracy: 0.6285
buy&sell test accuracy_t: 139 / 3393 = 0.041
buy&sell test accuracy_o: 139 / 366 = 0.3798



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 43/500
1015/1015 [==============================] - 294s 289ms/step - loss: 0.8449 - accuracy: 0.6580 - val_loss: 0.8581 - val_accuracy: 0.6435
[[ 123 1656   18]
 [  68 5531   26]
 [ 112 1480    4]]
f1 score: 0.5069881336248357
282/282 [==============================] - 15s 54ms/step - loss: 1.1246 - accuracy: 0.6274
buy&sell test accuracy_t: 127 / 3393 = 0.0374
buy&sell test accuracy_o: 127 / 351 = 0.3618



Epoch 44/500
1015/1015 [==============================] - 294s 289ms/step - loss: 0.8434 - accuracy: 0.6605 - val_loss: 0.8543 - val_accuracy: 0.6446
[[ 143 1614   40]
 [  83 5490   52]
 [ 121 1452   23]]
f1 score: 0.5142957794099727
282/282 [==============================] - 15s 54ms/step - loss: 1.0798 - accuracy: 0.6272
buy&sell test accuracy_t: 166 / 3393 = 0.0489
buy&sell test accuracy_o: 166 / 462 = 0.3593



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 45/500
1015/1015 [==============================] - 294s 289ms/step - loss: 0.8418 - accuracy: 0.6587 - val_loss: 0.8577 - val_accuracy: 0.6471
[[ 114 1668   15]
 [  51 5553   21]
 [ 102 1487    7]]
f1 score: 0.5068417809960727
282/282 [==============================] - 15s 54ms/step - loss: 1.1592 - accuracy: 0.6292
buy&sell test accuracy_t: 121 / 3393 = 0.0357
buy&sell test accuracy_o: 121 / 310 = 0.3903



Epoch 46/500
1015/1015 [==============================] - 294s 290ms/step - loss: 0.8411 - accuracy: 0.6605 - val_loss: 0.8557 - val_accuracy: 0.6468
[[ 105 1677   15]
 [  50 5553   22]
 [  93 1496    7]]
f1 score: 0.5046852138649195
282/282 [==============================] - 15s 54ms/step - loss: 1.1874 - accuracy: 0.6282
buy&sell test accuracy_t: 112 / 3393 = 0.033
buy&sell test accuracy_o: 112 / 292 = 0.3836



Epoch 47/500
1015/1015 [==============================] - 294s 290ms/step - loss: 0.8387 - accuracy: 0.6604 - val_loss: 0.8517 - val_accuracy: 0.6454
[[ 124 1645   28]
 [  66 5522   37]
 [ 109 1472   15]]
f1 score: 0.5096900701641104
282/282 [==============================] - 15s 54ms/step - loss: 1.1206 - accuracy: 0.6277
buy&sell test accuracy_t: 139 / 3393 = 0.041
buy&sell test accuracy_o: 139 / 379 = 0.3668



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 48/500
1015/1015 [==============================] - 294s 290ms/step - loss: 0.8383 - accuracy: 0.6594 - val_loss: 0.8524 - val_accuracy: 0.6465
[[ 128 1653   16]
 [  63 5540   22]
 [ 112 1480    4]]
f1 score: 0.5085228418557397
282/282 [==============================] - 16s 55ms/step - loss: 1.1329 - accuracy: 0.6290
buy&sell test accuracy_t: 132 / 3393 = 0.0389
buy&sell test accuracy_o: 132 / 345 = 0.3826



Epoch 49/500
1015/1015 [==============================] - 294s 289ms/step - loss: 0.8381 - accuracy: 0.6596 - val_loss: 0.8547 - val_accuracy: 0.6462
[[ 106 1671   20]
 [  47 5548   30]
 [  90 1497    9]]
f1 score: 0.5052464322520552
282/282 [==============================] - 12s 43ms/step - loss: 1.1570 - accuracy: 0.6280
buy&sell test accuracy_t: 115 / 3393 = 0.0339
buy&sell test accuracy_o: 115 / 302 = 0.3808



Epoch 50/500
1015/1015 [==============================] - 191s 189ms/step - loss: 0.8367 - accuracy: 0.6595 - val_loss: 0.8513 - val_accuracy: 0.6479
[[ 115 1662   20]
 [  57 5540   28]
 [ 103 1483   10]]
f1 score: 0.5072209492198712
282/282 [==============================] - 11s 38ms/step - loss: 1.1298 - accuracy: 0.6282
buy&sell test accuracy_t: 125 / 3393 = 0.0368
buy&sell test accuracy_o: 125 / 333 = 0.3754



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 51/500
1015/1015 [==============================] - 193s 190ms/step - loss: 0.8355 - accuracy: 0.6593 - val_loss: 0.8540 - val_accuracy: 0.6457
[[ 112 1661   24]
 [  53 5541   31]
 [ 104 1480   12]]
f1 score: 0.5073090527491356
282/282 [==============================] - 11s 38ms/step - loss: 1.1263 - accuracy: 0.6282
buy&sell test accuracy_t: 124 / 3393 = 0.0365
buy&sell test accuracy_o: 124 / 336 = 0.369



Epoch 52/500
1015/1015 [==============================] - 192s 190ms/step - loss: 0.8345 - accuracy: 0.6608 - val_loss: 0.8517 - val_accuracy: 0.6479
[[ 107 1662   28]
 [  53 5533   39]
 [  98 1482   16]]
f1 score: 0.5067450497004414
282/282 [==============================] - 11s 38ms/step - loss: 1.1407 - accuracy: 0.6272
buy&sell test accuracy_t: 123 / 3393 = 0.0363
buy&sell test accuracy_o: 123 / 341 = 0.3607



Epoch 53/500
1015/1015 [==============================] - 193s 190ms/step - loss: 0.8352 - accuracy: 0.6603 - val_loss: 0.8510 - val_accuracy: 0.6476
[[ 118 1663   16]
 [  56 5549   20]
 [ 110 1483    3]]
f1 score: 0.5066560532524219
282/282 [==============================] - 11s 38ms/step - loss: 1.1136 - accuracy: 0.6287
buy&sell test accuracy_t: 121 / 3393 = 0.0357
buy&sell test accuracy_o: 121 / 323 = 0.3746



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 54/500
1015/1015 [==============================] - 192s 189ms/step - loss: 0.8335 - accuracy: 0.6609 - val_loss: 0.8508 - val_accuracy: 0.6468
[[ 105 1672   20]
 [  51 5552   22]
 [  98 1489    9]]
f1 score: 0.5053994122506656
282/282 [==============================] - 11s 38ms/step - loss: 1.1624 - accuracy: 0.6283
buy&sell test accuracy_t: 114 / 3393 = 0.0336
buy&sell test accuracy_o: 114 / 305 = 0.3738



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 55/500
1015/1015 [==============================] - 193s 190ms/step - loss: 0.8329 - accuracy: 0.6606 - val_loss: 0.8499 - val_accuracy: 0.6471
[[ 109 1667   21]
 [  53 5544   28]
 [ 102 1485    9]]
f1 score: 0.5059422589936441
282/282 [==============================] - 11s 38ms/step - loss: 1.1541 - accuracy: 0.6279
buy&sell test accuracy_t: 118 / 3393 = 0.0348
buy&sell test accuracy_o: 118 / 322 = 0.3665



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 56/500
1015/1015 [==============================] - 248s 245ms/step - loss: 0.8302 - accuracy: 0.6611 - val_loss: 0.8505 - val_accuracy: 0.6479
[[ 110 1655   32]
 [  55 5538   32]
 [  98 1483   15]]
f1 score: 0.5075417195063685
282/282 [==============================] - 11s 37ms/step - loss: 1.1238 - accuracy: 0.6280
buy&sell test accuracy_t: 125 / 3393 = 0.0368
buy&sell test accuracy_o: 125 / 342 = 0.3655



Epoch 57/500
1015/1015 [==============================] - 192s 189ms/step - loss: 0.8311 - accuracy: 0.6594 - val_loss: 0.8515 - val_accuracy: 0.6471
[[ 104 1677   16]
 [  47 5559   19]
 [  93 1495    8]]
f1 score: 0.5051001989528816
282/282 [==============================] - 11s 38ms/step - loss: 1.1969 - accuracy: 0.6289
buy&sell test accuracy_t: 112 / 3393 = 0.033
buy&sell test accuracy_o: 112 / 287 = 0.3902



Epoch 58/500
1015/1015 [==============================] - 192s 189ms/step - loss: 0.8304 - accuracy: 0.6615 - val_loss: 0.8512 - val_accuracy: 0.6462
[[ 106 1664   27]
 [  52 5545   28]
 [  97 1486   13]]
f1 score: 0.5064121770525255
282/282 [==============================] - 11s 38ms/step - loss: 1.1564 - accuracy: 0.6281
buy&sell test accuracy_t: 119 / 3393 = 0.0351
buy&sell test accuracy_o: 119 / 323 = 0.3684



Epoch 59/500
1015/1015 [==============================] - 192s 189ms/step - loss: 0.8311 - accuracy: 0.6608 - val_loss: 0.8502 - val_accuracy: 0.6460
[[ 115 1656   26]
 [  56 5540   29]
 [ 105 1482    9]]
f1 score: 0.5072256808425237
282/282 [==============================] - 11s 38ms/step - loss: 1.1314 - accuracy: 0.6281
buy&sell test accuracy_t: 124 / 3393 = 0.0365
buy&sell test accuracy_o: 124 / 340 = 0.3647



Epoch 60/500
1015/1015 [==============================] - 193s 190ms/step - loss: 0.8292 - accuracy: 0.6614 - val_loss: 0.8491 - val_accuracy: 0.6460
[[ 120 1650   27]
 [  61 5531   33]
 [ 109 1479    8]]
f1 score: 0.5076377403679361
282/282 [==============================] - 11s 38ms/step - loss: 1.1261 - accuracy: 0.6275
buy&sell test accuracy_t: 128 / 3393 = 0.0377
buy&sell test accuracy_o: 128 / 358 = 0.3575



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 61/500
1015/1015 [==============================] - 193s 190ms/step - loss: 0.8284 - accuracy: 0.6609 - val_loss: 0.8524 - val_accuracy: 0.6451
[[ 104 1674   19]
 [  54 5556   15]
 [  95 1496    5]]
f1 score: 0.5042733241886853
282/282 [==============================] - 11s 38ms/step - loss: 1.2377 - accuracy: 0.6282
buy&sell test accuracy_t: 109 / 3393 = 0.0321
buy&sell test accuracy_o: 109 / 292 = 0.3733



Epoch 62/500
1015/1015 [==============================] - 194s 191ms/step - loss: 0.8297 - accuracy: 0.6611 - val_loss: 0.8511 - val_accuracy: 0.6449
[[ 119 1662   16]
 [  62 5544   19]
 [ 110 1483    3]]
f1 score: 0.5065384259412172
282/282 [==============================] - 11s 38ms/step - loss: 1.1608 - accuracy: 0.6283
buy&sell test accuracy_t: 122 / 3393 = 0.036
buy&sell test accuracy_o: 122 / 329 = 0.3708



Epoch 63/500
1015/1015 [==============================] - 194s 191ms/step - loss: 0.8283 - accuracy: 0.6606 - val_loss: 0.8532 - val_accuracy: 0.6465
[[ 106 1674   17]
 [  48 5561   16]
 [  99 1493    4]]
f1 score: 0.5048139928001623
282/282 [==============================] - 11s 38ms/step - loss: 1.1913 - accuracy: 0.6289
buy&sell test accuracy_t: 110 / 3393 = 0.0324
buy&sell test accuracy_o: 110 / 290 = 0.3793



Epoch 64/500
1015/1015 [==============================] - 194s 191ms/step - loss: 0.8266 - accuracy: 0.6606 - val_loss: 0.8487 - val_accuracy: 0.6465
[[ 110 1651   36]
 [  54 5522   49]
 [ 100 1477   19]]
f1 score: 0.5077992546431173
282/282 [==============================] - 11s 38ms/step - loss: 1.1739 - accuracy: 0.6266
buy&sell test accuracy_t: 129 / 3393 = 0.038
buy&sell test accuracy_o: 129 / 368 = 0.3505



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 65/500
1015/1015 [==============================] - 194s 191ms/step - loss: 0.8267 - accuracy: 0.6603 - val_loss: 0.8488 - val_accuracy: 0.6468
[[  98 1660   39]
 [  52 5530   43]
 [  83 1486   27]]
f1 score: 0.5072379145242353
282/282 [==============================] - 11s 39ms/step - loss: 1.1822 - accuracy: 0.6271
buy&sell test accuracy_t: 125 / 3393 = 0.0368
buy&sell test accuracy_o: 125 / 342 = 0.3655



Epoch 66/500
1015/1015 [==============================] - 194s 191ms/step - loss: 0.8270 - accuracy: 0.6617 - val_loss: 0.8536 - val_accuracy: 0.6435
[[  94 1679   24]
 [  46 5553   26]
 [  87 1496   13]]
f1 score: 0.5039271415922456
282/282 [==============================] - 11s 38ms/step - loss: 1.2547 - accuracy: 0.6276
buy&sell test accuracy_t: 107 / 3393 = 0.0315
buy&sell test accuracy_o: 107 / 290 = 0.369



Epoch 67/500
1015/1015 [==============================] - 192s 189ms/step - loss: 0.8266 - accuracy: 0.6611 - val_loss: 0.8506 - val_accuracy: 0.6465
[[ 103 1660   34]
 [  44 5539   42]
 [  92 1485   19]]
f1 score: 0.5070467410980839
282/282 [==============================] - 11s 38ms/step - loss: 1.1824 - accuracy: 0.6277
buy&sell test accuracy_t: 122 / 3393 = 0.036
buy&sell test accuracy_o: 122 / 334 = 0.3653



Epoch 68/500
1015/1015 [==============================] - 192s 190ms/step - loss: 0.8268 - accuracy: 0.6603 - val_loss: 0.8536 - val_accuracy: 0.6457
[[  95 1679   23]
 [  47 5551   27]
 [  90 1497    9]]
f1 score: 0.5030889494971609
282/282 [==============================] - 11s 38ms/step - loss: 1.2121 - accuracy: 0.6271
buy&sell test accuracy_t: 104 / 3393 = 0.0307
buy&sell test accuracy_o: 104 / 291 = 0.3574



Epoch 69/500
1015/1015 [==============================] - 194s 191ms/step - loss: 0.8258 - accuracy: 0.6612 - val_loss: 0.8486 - val_accuracy: 0.6474
[[  98 1654   45]
 [  46 5525   54]
 [  88 1474   34]]
f1 score: 0.5089428328362108
282/282 [==============================] - 11s 38ms/step - loss: 1.1682 - accuracy: 0.6273
buy&sell test accuracy_t: 132 / 3393 = 0.0389
buy&sell test accuracy_o: 132 / 365 = 0.3616



C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
Epoch 70/500
1015/1015 [==============================] - 194s 191ms/step - loss: 0.8254 - accuracy: 0.6608 - val_loss: 0.8532 - val_accuracy: 0.6424
[[ 104 1666   27]
 [  50 5546   29]
 [  96 1488   12]]
f1 score: 0.5057788405572762
282/282 [==============================] - 11s 38ms/step - loss: 1.1952 - accuracy: 0.6279
buy&sell test accuracy_t: 116 / 3393 = 0.0342
buy&sell test accuracy_o: 116 / 318 = 0.3648



Epoch 71/500
1015/1015 [==============================] - 194s 191ms/step - loss: 0.8240 - accuracy: 0.6603 - val_loss: 0.8569 - val_accuracy: 0.6435
[[  95 1680   22]
 [  43 5560   22]
 [  89 1501    6]]
f1 score: 0.5028117698880037
282/282 [==============================] - 11s 38ms/step - loss: 1.2503 - accuracy: 0.6277
buy&sell test accuracy_t: 101 / 3393 = 0.0298
buy&sell test accuracy_o: 101 / 277 = 0.3646



Epoch 72/500
1015/1015 [==============================] - 193s 190ms/step - loss: 0.8251 - accuracy: 0.6614 - val_loss: 0.8519 - val_accuracy: 0.6399
[[ 104 1670   23]
 [  55 5541   29]
 [  98 1490    8]]
f1 score: 0.5043980816882333
282/282 [==============================] - 11s 38ms/step - loss: 1.2137 - accuracy: 0.6269
buy&sell test accuracy_t: 112 / 3393 = 0.033
buy&sell test accuracy_o: 112 / 317 = 0.3533



Epoch 73/500
1015/1015 [==============================] - 193s 190ms/step - loss: 0.8243 - accuracy: 0.6616 - val_loss: 0.8538 - val_accuracy: 0.6429
[[ 107 1666   24]
 [  52 5548   25]
 [ 102 1486    8]]
f1 score: 0.5055862050341907
282/282 [==============================] - 11s 38ms/step - loss: 1.2215 - accuracy: 0.6280
buy&sell test accuracy_t: 115 / 3393 = 0.0339
buy&sell test accuracy_o: 115 / 318 = 0.3616



Epoch 74/500
1015/1015 [==============================] - 287s 283ms/step - loss: 0.8239 - accuracy: 0.6619 - val_loss: 0.8543 - val_accuracy: 0.6443
[[  83 1685   29]
 [  47 5550   28]
 [  79 1500   17]]
f1 score: 0.5022414747008077
282/282 [==============================] - 15s 54ms/step - loss: 1.2587 - accuracy: 0.6265
buy&sell test accuracy_t: 100 / 3393 = 0.0295
buy&sell test accuracy_o: 100 / 283 = 0.3534



Epoch 75/500
1015/1015 [==============================] - 291s 287ms/step - loss: 0.8223 - accuracy: 0.6621 - val_loss: 0.8505 - val_accuracy: 0.6435
[[ 100 1657   40]
 [  52 5535   38]
 [  88 1484   24]]
f1 score: 0.5073969947513949
282/282 [==============================] - 15s 54ms/step - loss: 1.1845 - accuracy: 0.6275
buy&sell test accuracy_t: 124 / 3393 = 0.0365
buy&sell test accuracy_o: 124 / 342 = 0.3626



Epoch 76/500
1015/1015 [==============================] - 291s 287ms/step - loss: 0.8204 - accuracy: 0.6625 - val_loss: 0.8556 - val_accuracy: 0.6449
[[ 101 1671   25]
 [  50 5553   22]
 [  94 1487   15]]
f1 score: 0.5061311488555715
282/282 [==============================] - 16s 54ms/step - loss: 1.2279 - accuracy: 0.6286
buy&sell test accuracy_t: 116 / 3393 = 0.0342
buy&sell test accuracy_o: 116 / 307 = 0.3779



Epoch 77/500
1015/1015 [==============================] - 256s 252ms/step - loss: 0.8211 - accuracy: 0.6613 - val_loss: 0.8547 - val_accuracy: 0.6454
[[  87 1682   28]
 [  39 5567   19]
 [  80 1499   17]]
f1 score: 0.504123181799051
282/282 [==============================] - 11s 38ms/step - loss: 1.2418 - accuracy: 0.6289
buy&sell test accuracy_t: 104 / 3393 = 0.0307
buy&sell test accuracy_o: 104 / 270 = 0.3852



Epoch 78/500
1015/1015 [==============================] - 193s 190ms/step - loss: 0.8210 - accuracy: 0.6627 - val_loss: 0.8526 - val_accuracy: 0.6468
[[  95 1670   32]
 [  45 5555   25]
 [  88 1489   19]]
f1 score: 0.5060086663596075
282/282 [==============================] - 11s 38ms/step - loss: 1.2137 - accuracy: 0.6286
buy&sell test accuracy_t: 114 / 3393 = 0.0336
buy&sell test accuracy_o: 114 / 304 = 0.375



Epoch 79/500
1015/1015 [==============================] - 193s 190ms/step - loss: 0.8205 - accuracy: 0.6616 - val_loss: 0.8505 - val_accuracy: 0.6437
[[  81 1661   55]
 [  44 5526   55]
 [  74 1483   39]]
f1 score: 0.5063303106713811
282/282 [==============================] - 11s 38ms/step - loss: 1.2176 - accuracy: 0.6261
buy&sell test accuracy_t: 120 / 3393 = 0.0354
buy&sell test accuracy_o: 120 / 348 = 0.3448



Epoch 80/500
1015/1015 [==============================] - 271s 267ms/step - loss: 0.8213 - accuracy: 0.6618 - val_loss: 0.8584 - val_accuracy: 0.6437
[[  84 1680   33]
 [  39 5562   24]
 [  76 1499   21]]
f1 score: 0.5042016033664098
282/282 [==============================] - 15s 54ms/step - loss: 1.2691 - accuracy: 0.6284
buy&sell test accuracy_t: 105 / 3393 = 0.0309
buy&sell test accuracy_o: 105 / 277 = 0.3791



Epoch 81/500
1015/1015 [==============================] - 292s 287ms/step - loss: 0.8208 - accuracy: 0.6624 - val_loss: 0.8548 - val_accuracy: 0.6432
[[  92 1670   35]
 [  46 5549   30]
 [  81 1492   23]]
f1 score: 0.5058901896654376
282/282 [==============================] - 15s 54ms/step - loss: 1.2650 - accuracy: 0.6281
buy&sell test accuracy_t: 115 / 3393 = 0.0339
buy&sell test accuracy_o: 115 / 307 = 0.3746



Epoch 82/500
1015/1015 [==============================] - 293s 289ms/step - loss: 0.8183 - accuracy: 0.6635 - val_loss: 0.8538 - val_accuracy: 0.6418
[[  97 1651   49]
 [  51 5532   42]
 [  83 1478   35]]
f1 score: 0.5093305930790574
282/282 [==============================] - 15s 54ms/step - loss: 1.2074 - accuracy: 0.6281
buy&sell test accuracy_t: 132 / 3393 = 0.0389
buy&sell test accuracy_o: 132 / 357 = 0.3697



Epoch 83/500
1015/1015 [==============================] - 294s 289ms/step - loss: 0.8188 - accuracy: 0.6629 - val_loss: 0.8525 - val_accuracy: 0.6440
[[ 123 1616   58]
 [  60 5483   82]
 [ 102 1452   42]]
f1 score: 0.5144164511172373
282/282 [==============================] - 15s 54ms/step - loss: 1.1613 - accuracy: 0.6263
buy&sell test accuracy_t: 165 / 3393 = 0.0486
buy&sell test accuracy_o: 165 / 467 = 0.3533



Epoch 84/500
1015/1015 [==============================] - 287s 283ms/step - loss: 0.8186 - accuracy: 0.6624 - val_loss: 0.8564 - val_accuracy: 0.6418
[[  98 1662   37]
 [  52 5546   27]
 [  85 1487   24]]
f1 score: 0.5074121224274499
282/282 [==============================] - 10s 36ms/step - loss: 1.2442 - accuracy: 0.6285
buy&sell test accuracy_t: 122 / 3393 = 0.036
buy&sell test accuracy_o: 122 / 323 = 0.3777



Epoch 85/500
1015/1015 [==============================] - 185s 182ms/step - loss: 0.8178 - accuracy: 0.6631 - val_loss: 0.8506 - val_accuracy: 0.6440
[[ 118 1639   40]
 [  60 5527   38]
 [  97 1472   27]]
f1 score: 0.511730792728952
282/282 [==============================] - 10s 37ms/step - loss: 1.1656 - accuracy: 0.6290
buy&sell test accuracy_t: 145 / 3393 = 0.0427
buy&sell test accuracy_o: 145 / 380 = 0.3816



Epoch 86/500
1015/1015 [==============================] - 186s 183ms/step - loss: 0.8182 - accuracy: 0.6636 - val_loss: 0.8522 - val_accuracy: 0.6443
[[ 117 1630   50]
 [  59 5519   47]
 [ 100 1461   35]]
f1 score: 0.5133282825889215
282/282 [==============================] - 10s 36ms/step - loss: 1.1894 - accuracy: 0.6289
buy&sell test accuracy_t: 152 / 3393 = 0.0448
buy&sell test accuracy_o: 152 / 408 = 0.3725



Epoch 87/500
1015/1015 [==============================] - 186s 183ms/step - loss: 0.8178 - accuracy: 0.6628 - val_loss: 0.8528 - val_accuracy: 0.6451
[[ 130 1620   47]
 [  64 5513   48]
 [ 107 1452   37]]
f1 score: 0.5162635856712442
282/282 [==============================] - 10s 37ms/step - loss: 1.1627 - accuracy: 0.6299
buy&sell test accuracy_t: 167 / 3393 = 0.0492
buy&sell test accuracy_o: 167 / 433 = 0.3857



Epoch 88/500
1015/1015 [==============================] - 187s 184ms/step - loss: 0.8159 - accuracy: 0.6637 - val_loss: 0.8520 - val_accuracy: 0.6449
[[ 117 1616   64]
 [  63 5490   72]
 [  99 1447   50]]
f1 score: 0.5154507893448785
282/282 [==============================] - 10s 36ms/step - loss: 1.1491 - accuracy: 0.6273
buy&sell test accuracy_t: 167 / 3393 = 0.0492
buy&sell test accuracy_o: 167 / 465 = 0.3591



Epoch 89/500
1015/1015 [==============================] - 186s 183ms/step - loss: 0.8179 - accuracy: 0.6619 - val_loss: 0.8534 - val_accuracy: 0.6435
[[ 121 1634   42]
 [  61 5529   35]
 [ 105 1462   29]]
f1 score: 0.513202542005447
282/282 [==============================] - 10s 36ms/step - loss: 1.1607 - accuracy: 0.6297
buy&sell test accuracy_t: 150 / 3393 = 0.0442
buy&sell test accuracy_o: 150 / 393 = 0.3817



Epoch 90/500
1015/1015 [==============================] - 186s 183ms/step - loss: 0.8148 - accuracy: 0.6648 - val_loss: 0.8523 - val_accuracy: 0.6443
[[ 103 1633   61]
 [  58 5509   58]
 [  88 1460   48]]
f1 score: 0.5127608872801254
282/282 [==============================] - 10s 37ms/step - loss: 1.1906 - accuracy: 0.6276
buy&sell test accuracy_t: 151 / 3393 = 0.0445
buy&sell test accuracy_o: 151 / 416 = 0.363



Epoch 91/500
1015/1015 [==============================] - 186s 183ms/step - loss: 0.8162 - accuracy: 0.6631 - val_loss: 0.8515 - val_accuracy: 0.6460
[[ 107 1629   61]
 [  54 5506   65]
 [  87 1456   53]]
f1 score: 0.5145926665903662
282/282 [==============================] - 10s 37ms/step - loss: 1.1641 - accuracy: 0.6283
buy&sell test accuracy_t: 160 / 3393 = 0.0472
buy&sell test accuracy_o: 160 / 427 = 0.3747



Epoch 92/500
1015/1015 [==============================] - 186s 183ms/step - loss: 0.8153 - accuracy: 0.6633 - val_loss: 0.8535 - val_accuracy: 0.6482
[[ 113 1626   58]
 [  60 5499   66]
 [  99 1455   42]]
f1 score: 0.5131341685436955
282/282 [==============================] - 10s 37ms/step - loss: 1.1666 - accuracy: 0.6270
buy&sell test accuracy_t: 155 / 3393 = 0.0457
buy&sell test accuracy_o: 155 / 438 = 0.3539



Epoch 93/500
1015/1015 [==============================] - 186s 183ms/step - loss: 0.8129 - accuracy: 0.6643 - val_loss: 0.8536 - val_accuracy: 0.6465
[[ 106 1636   55]
 [  60 5520   45]
 [  96 1459   41]]
f1 score: 0.5124553726067403
282/282 [==============================] - 10s 36ms/step - loss: 1.1749 - accuracy: 0.6284
buy&sell test accuracy_t: 147 / 3393 = 0.0433
buy&sell test accuracy_o: 147 / 403 = 0.3648



Epoch 94/500
1015/1015 [==============================] - 186s 183ms/step - loss: 0.8136 - accuracy: 0.6638 - val_loss: 0.8566 - val_accuracy: 0.6454
[[ 115 1627   55]
 [  62 5510   53]
 [ 102 1451   43]]
f1 score: 0.514413442115177
282/282 [==============================] - 10s 37ms/step - loss: 1.1837 - accuracy: 0.6285
buy&sell test accuracy_t: 158 / 3393 = 0.0466
buy&sell test accuracy_o: 158 / 430 = 0.3674



Epoch 95/500
1015/1015 [==============================] - 186s 184ms/step - loss: 0.8148 - accuracy: 0.6639 - val_loss: 0.8517 - val_accuracy: 0.6446
[[ 147 1584   66]
 [  83 5431  111]
 [ 118 1428   50]]
f1 score: 0.5186240253390395
282/282 [==============================] - 11s 37ms/step - loss: 1.1522 - accuracy: 0.6241
buy&sell test accuracy_t: 197 / 3393 = 0.0581
buy&sell test accuracy_o: 197 / 575 = 0.3426



Epoch 96/500
1015/1015 [==============================] - 187s 184ms/step - loss: 0.8114 - accuracy: 0.6652 - val_loss: 0.8610 - val_accuracy: 0.6429
[[ 102 1651   44]
 [  64 5529   32]
 [  88 1482   26]]
f1 score: 0.5080182101030585
282/282 [==============================] - 11s 37ms/step - loss: 1.2525 - accuracy: 0.6273
buy&sell test accuracy_t: 128 / 3393 = 0.0377
buy&sell test accuracy_o: 128 / 356 = 0.3596



Epoch 97/500
1015/1015 [==============================] - 186s 184ms/step - loss: 0.8132 - accuracy: 0.6642 - val_loss: 0.8558 - val_accuracy: 0.6476
[[ 109 1622   66]
 [  62 5475   88]
 [  96 1444   56]]
f1 score: 0.514168872493088
282/282 [==============================] - 11s 37ms/step - loss: 1.1903 - accuracy: 0.6254
buy&sell test accuracy_t: 165 / 3393 = 0.0486
buy&sell test accuracy_o: 165 / 477 = 0.3459



Epoch 98/500
1015/1015 [==============================] - 186s 184ms/step - loss: 0.8112 - accuracy: 0.6636 - val_loss: 0.8592 - val_accuracy: 0.6429
[[ 103 1649   45]
 [  61 5528   36]
 [  94 1475   27]]
f1 score: 0.5086129768150092
282/282 [==============================] - 11s 37ms/step - loss: 1.2479 - accuracy: 0.6274
buy&sell test accuracy_t: 130 / 3393 = 0.0383
buy&sell test accuracy_o: 130 / 366 = 0.3552



Epoch 99/500
1015/1015 [==============================] - 186s 183ms/step - loss: 0.8115 - accuracy: 0.6644 - val_loss: 0.8546 - val_accuracy: 0.6457
[[ 111 1610   76]
 [  71 5450  104]
 [  98 1436   62]]
f1 score: 0.5147131645150994
282/282 [==============================] - 10s 37ms/step - loss: 1.1596 - accuracy: 0.6235
buy&sell test accuracy_t: 173 / 3393 = 0.051
buy&sell test accuracy_o: 173 / 522 = 0.3314



Epoch 100/500
1015/1015 [==============================] - 186s 183ms/step - loss: 0.8116 - accuracy: 0.6631 - val_loss: 0.8535 - val_accuracy: 0.6451
[[ 108 1596   93]
 [  72 5404  149]
 [  93 1425   78]]
f1 score: 0.5150260619953404
282/282 [==============================] - 10s 37ms/step - loss: 1.1947 - accuracy: 0.6199
buy&sell test accuracy_t: 186 / 3393 = 0.0548
buy&sell test accuracy_o: 186 / 593 = 0.3137



Epoch 101/500
1015/1015 [==============================] - 186s 183ms/step - loss: 0.8118 - accuracy: 0.6652 - val_loss: 0.8571 - val_accuracy: 0.6457
[[  90 1657   50]
 [  49 5535   41]
 [  78 1486   32]]
f1 score: 0.5071602421767879
282/282 [==============================] - 10s 37ms/step - loss: 1.2363 - accuracy: 0.6273
buy&sell test accuracy_t: 122 / 3393 = 0.036
buy&sell test accuracy_o: 122 / 340 = 0.3588



Epoch 102/500
1015/1015 [==============================] - 186s 183ms/step - loss: 0.8106 - accuracy: 0.6666 - val_loss: 0.8547 - val_accuracy: 0.6432
[[ 111 1626   60]
 [  69 5494   62]
 [  98 1452   46]]
f1 score: 0.5133129359095654
282/282 [==============================] - 11s 37ms/step - loss: 1.2004 - accuracy: 0.6266
buy&sell test accuracy_t: 157 / 3393 = 0.0463
buy&sell test accuracy_o: 157 / 446 = 0.352



Epoch 103/500
1015/1015 [==============================] - 187s 184ms/step - loss: 0.8100 - accuracy: 0.6663 - val_loss: 0.8561 - val_accuracy: 0.6446
[[ 111 1634   52]
 [  74 5508   43]
 [  95 1468   33]]
f1 score: 0.5107756873753828
282/282 [==============================] - 11s 37ms/step - loss: 1.2494 - accuracy: 0.6267
buy&sell test accuracy_t: 144 / 3393 = 0.0424
buy&sell test accuracy_o: 144 / 408 = 0.3529



Epoch 104/500
1015/1015 [==============================] - 187s 184ms/step - loss: 0.8084 - accuracy: 0.6658 - val_loss: 0.8554 - val_accuracy: 0.6418
[[ 130 1621   46]
 [  88 5492   45]
 [ 111 1456   29]]
f1 score: 0.5130410803045856
282/282 [==============================] - 11s 37ms/step - loss: 1.2287 - accuracy: 0.6266
buy&sell test accuracy_t: 159 / 3393 = 0.0469
buy&sell test accuracy_o: 159 / 449 = 0.3541



Epoch 105/500
1015/1015 [==============================] - 187s 184ms/step - loss: 0.8110 - accuracy: 0.6650 - val_loss: 0.8558 - val_accuracy: 0.6432
[[ 115 1627   55]
 [  75 5494   56]
 [ 102 1460   34]]
f1 score: 0.5113095711062555
282/282 [==============================] - 11s 37ms/step - loss: 1.2546 - accuracy: 0.6257
buy&sell test accuracy_t: 149 / 3393 = 0.0439
buy&sell test accuracy_o: 149 / 437 = 0.341



Epoch 106/500
1015/1015 [==============================] - 187s 184ms/step - loss: 0.8086 - accuracy: 0.6653 - val_loss: 0.8601 - val_accuracy: 0.6437
[[ 125 1627   45]
 [  81 5504   40]
 [ 112 1458   26]]
f1 score: 0.512009142204437
282/282 [==============================] - 11s 37ms/step - loss: 1.2393 - accuracy: 0.6271
buy&sell test accuracy_t: 151 / 3393 = 0.0445
buy&sell test accuracy_o: 151 / 429 = 0.352



Epoch 107/500
1015/1015 [==============================] - 187s 184ms/step - loss: 0.8093 - accuracy: 0.6664 - val_loss: 0.8571 - val_accuracy: 0.6449
[[ 125 1623   49]
 [  87 5488   50]
 [ 107 1458   31]]
f1 score: 0.5122384612370358
282/282 [==============================] - 11s 37ms/step - loss: 1.2174 - accuracy: 0.6259
buy&sell test accuracy_t: 156 / 3393 = 0.046
buy&sell test accuracy_o: 156 / 449 = 0.3474



Epoch 108/500
1015/1015 [==============================] - 187s 184ms/step - loss: 0.8070 - accuracy: 0.6662 - val_loss: 0.8581 - val_accuracy: 0.6440
[[ 138 1608   51]
 [ 101 5472   52]
 [ 121 1444   31]]
f1 score: 0.5143015330597837
282/282 [==============================] - 11s 37ms/step - loss: 1.1981 - accuracy: 0.6255
buy&sell test accuracy_t: 169 / 3393 = 0.0498
buy&sell test accuracy_o: 169 / 494 = 0.3421



Epoch 109/500
1015/1015 [==============================] - 187s 184ms/step - loss: 0.8058 - accuracy: 0.6657 - val_loss: 0.8549 - val_accuracy: 0.6457
[[ 126 1600   71]
 [  94 5417  114]
 [ 112 1430   54]]
f1 score: 0.5142282746902833
282/282 [==============================] - 11s 37ms/step - loss: 1.2035 - accuracy: 0.6206
buy&sell test accuracy_t: 180 / 3393 = 0.0531
buy&sell test accuracy_o: 180 / 571 = 0.3152



Epoch 110/500
1015/1015 [==============================] - 187s 184ms/step - loss: 0.8076 - accuracy: 0.6652 - val_loss: 0.8626 - val_accuracy: 0.6449
[[  99 1640   58]
 [  75 5484   66]
 [  96 1456   44]]
f1 score: 0.5095303276977823
282/282 [==============================] - 11s 37ms/step - loss: 1.2388 - accuracy: 0.6240
buy&sell test accuracy_t: 143 / 3393 = 0.0421
buy&sell test accuracy_o: 143 / 438 = 0.3265



Epoch 111/500
1015/1015 [==============================] - 186s 184ms/step - loss: 0.8084 - accuracy: 0.6653 - val_loss: 0.8550 - val_accuracy: 0.6451
[[ 168 1545   84]
 [ 149 5302  174]
 [ 141 1385   70]]
f1 score: 0.5198927899556013
282/282 [==============================] - 11s 37ms/step - loss: 1.1543 - accuracy: 0.6143
buy&sell test accuracy_t: 238 / 3393 = 0.0701
buy&sell test accuracy_o: 238 / 786 = 0.3028



Epoch 112/500
1015/1015 [==============================] - 190s 187ms/step - loss: 0.8064 - accuracy: 0.6670 - val_loss: 0.8647 - val_accuracy: 0.6440
[[ 124 1618   55]
 [  92 5482   51]
 [ 111 1455   30]]
f1 score: 0.5116841220995408
282/282 [==============================] - 11s 38ms/step - loss: 1.2310 - accuracy: 0.6250
buy&sell test accuracy_t: 154 / 3393 = 0.0454
buy&sell test accuracy_o: 154 / 463 = 0.3326



Epoch 113/500
1015/1015 [==============================] - 193s 190ms/step - loss: 0.8064 - accuracy: 0.6652 - val_loss: 0.8632 - val_accuracy: 0.6435
[[ 101 1638   58]
 [  77 5494   54]
 [  98 1462   36]]
f1 score: 0.5087403219633693
282/282 [==============================] - 11s 37ms/step - loss: 1.2499 - accuracy: 0.6244
buy&sell test accuracy_t: 137 / 3393 = 0.0404
buy&sell test accuracy_o: 137 / 424 = 0.3231



Epoch 114/500
1015/1015 [==============================] - 187s 184ms/step - loss: 0.8063 - accuracy: 0.6654 - val_loss: 0.8579 - val_accuracy: 0.6432
[[ 116 1593   88]
 [  94 5377  154]
 [  98 1420   78]]
f1 score: 0.5149899058381193
282/282 [==============================] - 11s 37ms/step - loss: 1.2121 - accuracy: 0.6178
buy&sell test accuracy_t: 194 / 3393 = 0.0572
buy&sell test accuracy_o: 194 / 628 = 0.3089



Epoch 115/500
  25/1015 [..............................] - ETA: 2:58 - loss: 0.7303 - accuracy: 0.7212forrtl: error (200): program aborting due to control-C event
Image              PC                Routine            Line        Source
libifcoremd.dll    00007FFA6A2C3B58  Unknown               Unknown  Unknown
KERNELBASE.dll     00007FFAD06CB943  Unknown               Unknown  Unknown
KERNEL32.DLL       00007FFAD19C7034  Unknown               Unknown  Unknown
ntdll.dll          00007FFAD2EE2651  Unknown               Unknown  Unknown
  27/1015 [..............................] - ETA: 2:58 - loss: 0.7273 - accuracy: 0.7234forrtl: error (200): program aborting due to control-C event
Image              PC                Routine            Line        Source
libifcoremd.dll    00007FFA6A2C3B58  Unknown               Unknown  Unknown
KERNELBASE.dll     00007FFAD06CB943  Unknown               Unknown  Unknown
KERNEL32.DLL       00007FFAD19C7034  Unknown               Unknown  Unknown
ntdll.dll          00007FFAD2EE2651  Unknown               Unknown  Unknown